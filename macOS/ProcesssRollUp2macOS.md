# ProcessRollup2: macOS

# Description

Platforms: ChromeOS, Windows Legacy, Forensics

## Platforms: Windows, macOS

This event (often called "PR2" for short) is generated for a process that is running or has finished running on a host and contains information about that process. For every ProcessRollup2 event, there is a corresponding event that is generated when a process completes. The name of this event is EndOfProcess for Windows and Mac and TerminateProcess for Linux.

Important: This event is generated on Windows, Mac, and Linux sensors. However, because of the way Mac and Linux manage processes at the kernel level, the Falcon sensors for these platforms are configured to send ProcessRollup2information in a second event called ProcessRollup2Stats. For more information, see ProcessRollup2Stats.

# Understanding TargetProcessId_decimal

Every ProcessRollup2 event contains a field called TargetProcessId_decimal. This ID is generated internally by the sensor, and will be unique for every instance of a process. For example, if you run cmd.exe twice, you will see two diﬀerent ProcessRollup2 events with two unique values for TargetProcessId_decimal. This ID should not be confused with the host operating system PID for the process, which will be a diﬀerent value.

# Understanding ContextProcessId_decimal

Processes often generate multiple, if not dozens of related events. For example, opening a browser or running an executable can generate network connectivity events, temporary file write events, DNS request events, etc. We therefore need a way to understand the parent-child relationship between processes and the events they generate.

Every event that is generated by a ProcessRollup2 contains a data field called ContextProcessId_decimal. The ContextProcessId_decimal will match the TargetProcessId_decimal of its parent ProcessRollup2 event. In the example below, the ContextProcessId_decimal values indicate that each of the events are children of the parent ProcessRollup2events.


<!-- ProcessRollup2 ProcessRollup2 TargetProcessId_decimal: TargetProcessId_decimal: 1234 5678 The Target Process ID of the NetworkConnectlP4 PEFileWritten ProcessRollup2 event matches the Context Process ContextProcessId_decimal: ContextProcessId_decimal: 1234 5678 ID of the InjectedThread event.InjectedThreadis therefore the child of this ProcessRollup2 event. DnsRequest InjectedThread ContextProcessId_decimal: ContextProcessId_decimal: 1234 5678 -->
![](https://web-api.textin.com/ocr_image/external/78c34bd269fbc5ef.jpg)

By searching for events that have matching values for ContextProcessId_decimal and TargetProcessId_decimalL,you can see a list of all events that were generated as a result of a ProcessRollup2 event.

# Understanding ParentProcessld_decimal

As previously mentioned, every process that executes on a host has a corresponding ProcessRollup2 event. This means that when a process spawns another process, a brand new ProcessRollup2 event will be generated for that new ProcessRollup2event. This new event will contain a field called ParentProcessId_decimal.The ParentProcessId_decimal of the child PR2 will match the TargetProcessId_decimal of the parent PR2, as shown below:


![](assets/0.png)

By searching for events that have matching values for ParentProcessId_decimal and TargetProcessId_decimal, you can determine the parent-child relationship of multiple ProcessRollup2 events.



## Platforms: Linux, Falcon Container, Android

This event (often called "PR2" for short) is generated for a process that is running or has finished running on a host and contains information about that process. For every ProcessRollup2 event, there is a corresponding event that is generated when a process completes. The name of this event is EndOfProcess for Windows and Mac and TerminateProcess for Linux.


| Important: This event is generated on Windows, Mac, and Linux sensors. However, because of the way Mac and Linux manage processes at the kernel level, the Falcon sensors for these platforms are configured to send ProcessRollup2information in a second event called<br>ProcessRollup2Stats. For more information, see ProcessRollup2Stats.  |
| --- |


Fields: macOS


| Field  | Description  |
| --- | --- |
| TargetProcessId  | The unique ID of a target process (in decimal, non-hex format). This field exists in almost all events, and it represents the ID of the process that is responsible for the activity of the event in focus. For example, the TargetProcessId of a process that performed<br>thread injection in an InjectedThread event  |
| SourceProcessId  | UPID of creating process.<br>Note that in Windows [http://msdn.microsoft.com/en-us/library/windows/hardware/ﬀ559960%28v=vs.85%29.aspx] , the ParentProcessId does not have to be the same as SourceProcessId since a diﬀerent parent can be specified for creation. On<br>Mac, SourceProcessId is the responsible_pid which is used by XPC to note the process requesting this XPC process.  |
| SourceThreadId  | UTID of thread from creating process. See the description for the SourceProcessId field for more details.  |
| ParentProcessId  | The decimal representation of the parent process.  |
| ImageFileName  | The full path to an executable (PE) file. The context of this field provides more information as to its meaning. For ProcessRollup2 events, this is the full path to the main executable for the created process.  |
| CommandLine  | The command line used to create this process. May be empty in some circumstances, visit here [http://msdn.microsoft.com/en-us/library/windows/desktop/ms682425(v=vs.85).aspx] for more information.  |
| RawProcessId  | The operating system’s internal PID. For matching, use the UPID fields which guarantee a unique process identifier  |
| ProcessGroupId  |  |
| UID  | Unix User Identifier.  |
| RUID  | The real UID for a unix style process.  |
| SVUID  | The saved eﬀective UID for a unix style process.  |
| GID  | Unix Group Identifier.  |
| RGID  | The real GID for a unix style process.  |
| SVGID  | The saved eﬀective UID for a unix style process.  |
| SHA256HashData  | The SHA256 hash of a file. In most cases, the hash of the file referred to by the ImageFileName field.<br>Values:<br>STATIC_SHA256_DOPPELGANGING (0x56f3097c4d5bf4c7cﬀef168ee732e1c78f2ee62bc1c1ba61c219226bef619f8)<br>STATIC_SHA256_SYSTEM (0x03312a19baa7ab137c09127c6feb58c05216a7880d3c9e6ae54a8bcda460f92a)  |
| SHA1HashData  | The SHA1 hash of a file.  In most cases, the hash of the file referred to by the ImageFileName field.  |
| MD5HashData  | The MD5 hash of a file  |
| ProcessStartTime  | The time the process began in UNIX epoch time (in decimal, non-hex format).  |
| ProcessEndTime  | The time the process finished (in decimal, non-hex format).  |
| TreeId  | If this event is part of a detection tree, the tree ID it is part of.  |
| Tags  | Field used for Falcon diagnostic information.  |
| MachOSubType  | Values:<br>UNKNOWN (0)<br>EXECUTABLE64 (1)<br>DYLIB64 (2)<br>BUNDLE64 (3)  |



